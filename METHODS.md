# Methods: Single-Nucleus RNA-seq Analysis

## Overview

This document describes the analytical workflows used to process and analyze
single-nucleus RNA-sequencing (snRNA-seq) data. The methods emphasize
reproducibility, statistical rigor, and biological interpretability.

---

## Quality Control and Filtering

Raw count matrices were imported into Seurat for downstream analysis.
Quality control metrics included the number of detected features and total
counts per nucleus. Thresholds were selected conservatively and adapted to
the nuclear origin of the data.

Mitochondrial read percentage was evaluated but not used as a strict filtering
criterion, as mitochondrial transcripts are less informative in snRNA-seq.

---

## Doublet Handling and Ambient RNA

Doublet handling strategies were dataset-dependent. When raw Cell Ranger
outputs were available, CellBender was used to model ambient RNA and technical
background. For processed Seurat objects, score-based approaches such as scds
were optionally applied.

Doublet filtering was performed conservatively to minimize the removal of
biologically valid nuclei.

---

## Normalization and Feature Selection

Data were normalized using log-normalization, followed by identification of
highly variable features. Normalization and scaling were performed prior to
dimensionality reduction.

For cell-type–specific analyses, re-normalization was performed after
subsetting to avoid dominance of global variance structure.

---

## Dimensionality Reduction and Integration

Principal component analysis (PCA) was used for dimensionality reduction.
Batch effects arising from sample or experimental differences were corrected
using Harmony.

The number of principal components retained was guided by variance explained
and dataset complexity.

---

## Clustering and Cell Type Annotation

Graph-based clustering was performed on the integrated embedding.
Clusters were annotated using canonical marker genes and manual inspection.

Annotations were assigned conservatively when marker expression was ambiguous.

---

## Cell-Type–Specific Subclustering

To resolve heterogeneity within abundant populations, hepatocytes were
subclustered separately. Subclustering included re-normalization, PCA,
graph-based clustering, and UMAP visualization.

Subclusters were annotated based on known zonation and stress-associated
marker genes.

---

## Pseudobulk Differential Expression

Pseudobulk expression matrices were generated by aggregating counts at the
sample level within each cell type. Differential expression was performed
using edgeR with empirical Bayes moderation.

This approach improves statistical robustness and respects biological
replication.

---

## Cell Type Composition Analysis

Cell-type proportions were calculated per sample and compared across
conditions to distinguish transcriptional changes from abundance shifts.

---

## Pathway Enrichment Analysis

Gene set enrichment analysis (GSEA) was applied to ranked pseudobulk results
using Hallmark gene sets. Over-representation analysis (ORA) was performed
using Gene Ontology Biological Process terms on significantly differentially
expressed genes.

---

## Latent Space Modeling

Latent transcriptional structure was explored using scVI, a probabilistic
deep-learning framework. scVI was used for exploratory validation and was not
used for annotation or differential expression.

---

## Limitations

Parameter choices are dataset-specific and may require adaptation.
Biological interpretation remains a critical component of the analysis.
